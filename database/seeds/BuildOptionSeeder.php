<?php

use App\Model\Build;

use App\Model\BuildLevelOptionType;
use Illuminate\Database\Seeder;
use Illuminate\Support\Collection;

class BuildOptionSeeder extends Seeder
{
    /**
     * Run the database seeds.
     *
     * @return void
     */
    public function run()
    {
        $builds = [
            'main_building' => [
                'build_time' => [5, 1, 0.96, 0.93, 0.9, 0.86, 0.83, 0.8, 0.77, 0.75, 0.72, 0.69, 0.67, 0.64, 0.62, 0.6, 0.58, 0.56, 0.54, 0.52, 0.5]
            ],
            'sawmill' => [
                'production' => [0, 0.05, 0.10, 0.15, 0.20, 0.25]
            ],
            'brickworks' => [
                'production' => [0, 0.05, 0.10, 0.15, 0.20, 0.25]
            ],
            'iron_foundry' => [
                'production' => [0, 0.05, 0.10, 0.15, 0.20, 0.25]
            ],
            'flour_mill' => [
                'production' => [0, 0.05, 0.10, 0.15, 0.20, 0.25]
            ],
            'bakery' => [
                'production' => [0, 0.05, 0.10, 0.15, 0.20, 0.25]
            ],
            'barracks' => [
                'make_speed' => [0,1.0,1.1,1.2,1.4,1.5,1.7,1.9,2.1,2.3,2.6,2.9,3.2,3.5,3.9,4.4,4.9,5.4,6.0,6.7,7.4]
            ],
            'big_barracks' => [
                'make_speed' => [0,1.0,1.1,1.2,1.4,1.5,1.7,1.9,2.1,2.3,2.6,2.9,3.2,3.5,3.9,4.4,4.9,5.4,6.0,6.7,7.4]
            ],
            'barn' => [
                'capacity' => [800,1200,1700,2300,3100,4000,5000,6300,7800,9600,11800,14400,17600,21400,25900,31300,37900,45700,55100,66400,80000]
            ],
            'warehouse' => [
                'capacity' => [800,1200,1700,2300,3100,4000,5000,6300,7800,9600,11800,14400,17600,21400,25900,31300,37900,45700,55100,66400,80000]
            ],
            'cache' => [
                'capacity' => [0,100,130,170,220,280,360,460,600,720,1000]
            ],
            'stable' => [
                'make_speed' => [0,1.0,1.1,1.2,1.4,1.5,1.7,1.9,2.1,2.3,2.6,2.9,3.2,3.5,3.9,4.4,4.9,5.4,6.0,6.7,7.4]
            ],
            'big_stable' => [
                'make_speed' => [0,1.0,1.1,1.2,1.4,1.5,1.7,1.9,2.1,2.3,2.6,2.9,3.2,3.5,3.9,4.4,4.9,5.4,6.0,6.7,7.4]
            ],
            'workshop' => [
                'make_speed' => [0,1.0,1.1,1.2,1.4,1.5,1.7,1.9,2.1,2.3,2.6,2.9,3.2,3.5,3.9,4.4,4.9,5.4,6.0,6.7,7.4]
            ],
            'arena' => [
                'move_speed' => [0,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2.0,2.1,2.2,2.3,2.4,2.5,2.6,2.7,2.8,2.9,3.0]
            ],
            'forge' => [
                'access' => [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]
            ],
            'embassy' => [
                'max_members' => [0,0,0,9,12,15,18,21,24,27,30,33,36,39,42,45,48,51,54,57,60]
            ],
            'residence' => [
                'defence_value' => [0,2,8,18,32,50,72,98,128,162,200,242,288,338,392,450,512,578,648,722,800]
            ],
            'palace' => [
                'defence_value' => [0,2,8,18,32,50,72,98,128,162,200,242,288,338,392,450,512,578,648,722,800]
            ],
            'market' => [
                'traders' => [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]
            ],
            'chamber_of_commerce' => [
                'capacity' => [0,1.1,1.2,1.3,1.4,1.5,1.6,1.7,1.8,1.9,2.0,2.1,2.2,2.3,2.4,2.5,2.6,2.7,2.8,2.9,3.0]
            ],
            'city_wall' => [
                'defence_factor' => [1.00, 1.03, 1.061, 1.093, 1.126, 1.159, 1.194, 1.23, 1.267, 1.305, 1.344, 1.384, 1.426, 1.469, 1.513, 1.558, 1.605, 1.653, 1.702, 1.754, 1.806],
                'defence_value' => [0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200],
                'need_rams' => [0, 1, 2, 2, 3, 4, 6, 8, 10, 12, 14, 17, 20, 23, 27, 31, 35, 39, 43, 48, 53]
            ],
            'hedge' => [
                'defence_factor' => [1.00, 1.025, 1.051, 1.077, 1.104, 1.131, 1.160, 1.189, 1.218, 1.249, 1.280, 1.312, 1.345, 1.379, 1.413, 1.448, 1.485, 1.522, 1.560, 1.599, 1.639],
                'defence_value' => [0, 8, 16, 24, 32, 40, 48, 56, 64, 72, 80, 88, 96, 104, 112, 120, 128, 136, 144, 152, 160],
                'need_rams' => [0, 1, 2, 4, 6, 8, 11, 15, 19, 23, 28, 34, 40, 46, 53, 61, 69, 77, 86, 96, 106]
            ],
            'earthworks' => [
                'defence_factor' => [1.00, 1.02, 1.04, 1.061, 1.082, 1.104, 1.126, 1.149, 1.172, 1.195, 1.219, 1.243, 1.268, 1.294, 1.319, 1.346, 1.373, 1.400, 1.428, 1.457, 1.486],
                'defence_value' => [0, 6, 12, 18, 24, 30, 36, 42, 48, 54, 60, 66, 72, 78, 84, 90, 96, 102, 108, 114, 120],
                'need_rams' => [0, 1, 4, 8, 13, 19, 27, 36, 46, 57, 69, 83, 98, 114, 132, 151, 171, 192, 214, 238, 263]
            ],
        ];
        $all_builds = Build::with('levels')->get();
        $options = new Collection();
        foreach ($builds as $build_title => $build_options) {
            $build = $all_builds->where('title', $build_title)->first();
            foreach ($build_options as $key => $build_option) {
                if (!$options->has($key)) {
                    $option_type = BuildLevelOptionType::create(['type' => $key]);
                    $options->push($key);
                } else {
                    $option_type = BuildLevelOptionType::where('type', $key)->first();
                }
                for ($level = 0; $level < count($build_option); $level++) {
                    $build->levels->where('level', $level)->first()->options()->create([
                        'build_level_option_type_id' => $option_type->id,
                        'value' => $build_option[$level]
                    ]);
                }
            }
        }
    }
}
